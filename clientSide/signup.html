<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To Do | Sign Up</title>
    <link rel="stylesheet" type="text/css" href="/styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="apple-touch-icon" sizes="180x180" href="/Images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/Images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/Images/favicon/favicon-16x16.png">
    <link rel="manifest" href="/Images/favicon/site.webmanifest">
</head>
<body class="montserrat">
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="/home">
                <img src="/Images/to do logo.png" alt="Logo" height="50px" width="auto">
            </a>
            <button class="btn menu d-block d-lg-none" type="button" data-bs-target="#navbarSupportedContent" data-bs-toggle="collapse" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
                <img src="/Images/hamburger-menu-svgrepo-com.svg" alt="Nav Menu Icon" height="35px" width="auto">
            </button>     
            <div id="navbarSupportedContent" class="collapse navbar-collapse">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/pricing">Pricing</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/contact">Contact Us</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/signup">Sign Up</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/login">Login</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid bg-img signup py-5">
        <div class="container d-flex justify-content-center align-items-center" style="height: 100%;">
            <div class="col-11 col-md-8 col-xl-6 mx-auto shadow p-5 border rounded-4 bg-white slideUpAnimation signup">
                <h1>Sign Up</h1>
                <form class="mt-3" id="signupForm">
                    <div class="form-group mb-3">
                        <input type="text" class="form-control capitalize" required id="firstNameInput" oninput="capitalizeFirstLetter(this)" placeholder="First Name">
                    </div>
                    <div class="form-group mb-3">
                        <input type="text" class="form-control capitalize" required id="lastNameInput" oninput="capitalizeFirstLetter(this)" placeholder="Last Name">
                    </div>
                    <div class="form-group mb-3">
                        <input type="email" class="form-control" required id="usernameInput" placeholder="Email Address">
                    </div>
                    <div class="form-group mb-3 passwordInputField d-flex align-items-center">
                        <input type="password" class="form-control" required id="passwordInput" minlength="8" placeholder="Password">
                        <button id="togglePassword" type="button" class="showButton">
                            <img id="toggleIcon" src="/Images/eye-off-svgrepo-com.svg" alt="Show Password" height="20px" width="auto">
                        </button>
                    </div>
                    <h5>Plan Type</h5>
                    <div class="d-flex align-items-md-center justify-content-between flex-column flex-md-row gap-3 my-3">
                        <div class="d-flex align-items-center gap-2">
                            <input type="checkbox" id="freeAccount" class="accountCheckbox checkpoint">
                            <span>Free</span>
                        </div>
                        <div class="d-flex align-items-center gap-2">
                            <input type="checkbox" id="starterAccount" class="accountCheckbox checkpoint">
                            <span>Starter</span>
                        </div>
                        <div class="d-flex align-items-center gap-2">
                            <input type="checkbox" id="standardAccount" class="accountCheckbox checkpoint">
                            <span>Standard</span>
                        </div>
                        <div class="d-flex align-items-center gap-2">
                            <input type="checkbox" id="premiumAccount" class="accountCheckbox checkpoint">
                            <span>Premium</span>
                        </div>
                    </div>
                    <div id="paymentDetails" class="d-none">
                        <h5 class="mb-3">Payment Details</h5>
                        <div id="cardDetails">
                            <div class="d-flex align-items-md-center justify-content-between flex-column flex-md-row gap-3 my-3">
                                <div class="d-flex align-items-center gap-2">
                                    <input type="checkbox" id="visa" class="payCard checkpoint">
                                    <span>Visa</span>
                                </div>
                                <div class="d-flex align-items-center gap-2">
                                    <input type="checkbox" id="mastercard" class="payCard checkpoint">
                                    <span>Mastercard</span>
                                </div>
                                <div class="d-flex align-items-center gap-2">
                                    <input type="checkbox" id="amex" class="payCard checkpoint">
                                    <span>Amex</span>
                                </div>
                            </div>
                            <div class="form-group mb-3">
                                <input id="cardNumber" type="text" class="form-control" maxlength="19" minlength="19" placeholder="Card Number">
                            </div>
                            <div class="d-flex gap-3">
                                <div class="form-group mb-3">
                                    <input id="cardExpiry" type="text" class="form-control" maxlength="7" minlength="7" placeholder="Card Expiry">
                                </div>
                                <div class="form-group mb-3">
                                    <input id="cardCvv" type="text" class="form-control" minlength="3" maxlength="4" placeholder="CVV">
                                </div>
                            </div>
                            <p><small>
                                You are signing up for one of our paid plans. The first 30 days will be at no charge. 
                                You will then be billed monthly after the 30 day trial period. If you do not wish for this to happen, cancel anytime.
                            </small></p>
                        </div>
                    </div>
                    <hr>
                    <div id="termsAndConditionsCheckboxes">
                        <div class="d-flex gap-3 mb-3">
                            <input type="checkbox" required id="terms&conditions" class="checkpoint">
                            <span>I have read and understand the terms and conditions</span>
                        </div>
                        <div class="d-flex gap-3 mb-3">
                            <input type="checkbox" required id="permission" class="checkpoint">
                            <span>I give permission for 'To Do' to handle and store my data via encryption</span>
                        </div>
                    </div>
                    <div class="d-flex w-100 gap-3 align-items-center justify-content-between">
                        <button disabled id="signUpButton" type="submit" class="btn btn-primary">Sign Up</button>
                        <a class="ms-auto nav-link account text-end col-6" style="padding: 0 !important;" href="/login">Already have an account?</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <footer class="footer">
        <div class="container">
            <p class="text-center mb-0">All rights reserved | &COPY; To Do 2024</p>
        </div>
    </footer>


    <script>
        document.addEventListener('DOMContentLoaded', () => {

        const checkboxes = document.querySelectorAll('.accountCheckbox');
        const freeAccount = document.getElementById('freeAccount');
        const starterAccount = document.getElementById('starterAccount');
        const standardAccount = document.getElementById('standardAccount');
        const premiumAccount = document.getElementById('premiumAccount');
        const paymentDetails = document.getElementById('paymentDetails');   
        const signUpButton = document.getElementById('signUpButton'); 
        const firstName = document.getElementById('firstNameInput');
        const lastName = document.getElementById('lastNameInput');
        const username = document.getElementById('usernameInput');
        const password = document.getElementById('passwordInput');
        const cards = document.querySelectorAll('.payCard');
        const amex = document.getElementById('amex');
        const visa = document.getElementById('visa');
        const mastercard = document.getElementById('mastercard');
        const cardNumber = document.getElementById('cardNumber');
        const cardExpiry = document.getElementById('cardExpiry');
        const cardCvv = document.getElementById('cardCvv');
        const termsAndConditions = document.getElementById('terms&conditions');
        const permissions = document.getElementById('permission');
        const signupForm = document.getElementById('signupForm');
        const termsAndConditionsCheckboxes = document.getElementById('termsAndConditionsCheckboxes');
        const togglePassword = document.getElementById('togglePassword');
        const toggleIcon = document.getElementById('toggleIcon');

        const resetFields = () => {
            freeAccount.checked = false;
            starterAccount.checked = false;
            standardAccount.checked = false;
            premiumAccount.checked = false;
            amex.checked = false;
            visa.checked = false;
            mastercard.checked = false;
            permissions.checked = false;
            termsAndConditions.checked = false;
            firstName.value = '';
            lastName.value = '';
            username.value = '';
            password.value = '';
            cardNumber.value = '';
            cardExpiry.value = '';
            cardCvv.value = '';
            signUpButton.setAttribute('disabled', true);
        }

        window.onload = resetFields;

        cardNumber.addEventListener('input', function (event) {
            let input = this.value.replace(/\D/g, '');
            let formatted = '';
            for (let i = 0; i < input.length; i += 4) {
                formatted += input.substr(i, 4) + ' ';
            }
            this.value = formatted.trim();
        });

        cardExpiry.addEventListener('input', function (event) {
            let input = this.value.replace(/\D/g, '');
            if (input.length > 2) {
                input = input.substring(0, 2) + ' / ' + input.substring(2, 4);
            } else if (input.length > 0) {
                input = input.substring(0, 2);
            }

            this.value = input;
        });

        togglePassword.addEventListener('click', () => {
            const type = password.type === 'password' ? 'text' : 'password';
            password.type = type

            toggleIcon.src = type === 'password' ? '/Images/eye-off-svgrepo-com.svg' : '/Images/eye-svgrepo-com.svg'
        });
        
        function capitalizeFirstLetter(input) {
            const words = input.value.split(' ');
            input.value = words.map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()).join(' ');
        };

        function termsAndConditionsMet() {
            if (termsAndConditions.checked && permissions.checked) {
                signUpButton.disabled = false;
            } else {
                signUpButton.disabled = true;
            }
        };

        function checkCardDetails() {
            if (cardNumber.value == '' || cardExpiry.value == '' || cardCvv.value == '') {
                signUpButton.disabled = true;
            } else {
                signUpButton.disabled = false;
            }
        }

        function checkPaymentDetails() { 
            paymentDetails.addEventListener('change', function() {
                if ((visa.checked || mastercard.checked || amex.checked) && (cardNumber.value !== '' && cardExpiry.value !== '' && cardCvv.value !== '')) {
                    termsAndConditionsCheckboxes.addEventListener('change', termsAndConditionsMet);
                } else {
                    cardNumber.addEventListener('change', checkCardDetails);
                    cardExpiry.addEventListener('change', checkCardDetails);
                    cardCvv.addEventListener('change', checkCardDetails);
                }
            })
        };

        function checkSignupFields() {
            if ((firstName.value !== '' && lastName.value !== '' && username.value !== '' && password.value !== '') && (starterAccount.checked || standardAccount.checked || premiumAccount.checked)) {
                    paymentDetails.classList.add('d-block');
                    paymentDetails.classList.remove('d-none');
                    signUpButton.disabled = true;
                    visa.checked = false;
                    mastercard.checked = false;
                    amex.checked = false;
                    termsAndConditions.checked = false;
                    permissions.checked = false;
                    cardNumber.value = '';
                    cardExpiry.value = '';
                    cardCvv.value = '';

                    checkPaymentDetails();       
            } else {
                    paymentDetails.classList.add('d-none');
                    paymentDetails.classList.remove('d-block');
                    signUpButton.disabled = true;
            }
        };
        
        freeAccount.addEventListener('change', termsAndConditionsMet);
        starterAccount.addEventListener('change', checkSignupFields);
        standardAccount.addEventListener('change', checkSignupFields);
        premiumAccount.addEventListener('change', checkSignupFields);

        firstName.addEventListener('input', checkSignupFields);
        lastName.addEventListener('input', checkSignupFields);
        username.addEventListener('input', checkSignupFields);
        password.addEventListener('input', checkSignupFields);

        signupForm.addEventListener('change', function() {   
            if ((firstName.value !== '' && lastName.value !== '' && username.value !== '' && password.value !== '') && (freeAccount.checked)) {
                paymentDetails.classList.remove('d-block');
                paymentDetails.classList.add('d-none');
                termsAndConditionsMet();
            };
            
            if ((firstName.value == '' || lastName.value == '' || username.value == '' || password.value == '') && (freeAccount.checked || starterAccount.checked || standardAccount.checked || premiumAccount.checked)) {
                paymentDetails.classList.remove('d-block');
                paymentDetails.classList.add('d-none');
                signUpButton.disabled = true;
                window.alert('Fill in required fields')
                freeAccount.checked = false;
                starterAccount.checked = false;
                standardAccount.checked = false;
                premiumAccount.checked = false;
            };
        });

        checkboxes.forEach(checkbox => {                                   
            checkbox.addEventListener('change', function() {
                if (this.checked) {
                    checkboxes.forEach(cb => {
                        if (cb !== this) {
                            cb.checked = false;
                        }
                    });
                } else {
                    checkboxes.forEach(cb => cb.checked = false);
                };
            });
        });

        cards.forEach(card => {
            card.addEventListener('change', function() {
                if (this.checked) {
                    cards.forEach(otherCard => {
                        if (otherCard !== this) {
                            otherCard.checked = false;
                        }
                    });
                } else {
                    cards.forEach(otherCard => otherCard.checked = false);
                }
            });
        });
    
        signupForm.addEventListener('submit', event => {
            event.preventDefault();

            console.log('Username:', username.value);
            console.log('Password:', password.value);
            console.log('First Name:', firstName.value);
            console.log('Last Name:', lastName.value); // Log the values to debug

            if (username.value === '' || password.value === '' || firstName.value === '' || lastName.value === '') {
                console.error('One or more fields are empty');
                return;
            }

            // send signup data to the server
            fetch('/signup', {
                method: 'POST', 
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ email: username.value, password: password.value, firstName: firstName.value, lastName: lastName.value })
            })
            .then(response => {
                if (!response.ok) {
                    window.alert("Password Requirements:\n- At least one digit.\n- At least one lowercase letter.\n- At least one uppercase letter.\n- At least one special character.\n- Minimum length of 8 characters.");
                    throw new Error('Failed to sign up');
                }
                // Optionally, you can redirect the user to a different page after submission
                window.location.href = '/login'; // Redirect to login page
            })
            .catch(error => {
                console.error('Error signing up:', error);
                // Handle sign up error, display error message to user etc.
            });
        });
        });
    </script>







<script src="js.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>